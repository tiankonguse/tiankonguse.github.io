---
layout: post
title: CSP-S 2021 编程算法比赛
description: 对偶图上最短路后转环形DP            
keywords: 算法,CSP,算法比赛
tags: [算法, CSP, 算法比赛]
categories: [算法]
updateDate: 2025-08-09 12:13:00
published: false
---



## 零、背景


最近我计划研究 CSP-J 与 CSP-S 的比赛题目，之前已经完成了 7 场比赛的题解，今天将分享 2021 年 CSP-S 第二轮编程算法比赛的详细题解。  


A: 二分+线段树 
B: 语法解析+动态规划 
C: 贪心搜索  
D: 对偶图+最短路+环形DP    


代码地址： https://github.com/tiankonguse/leetcode-solutions/tree/master/other/CSP-S/  


![](https://res2025.tiankonguse.com/images/2025/08/09/001.png)  


| 比赛题目分类与题解 |
| --- |
| [CSP-J 2024 题解](https://mp.weixin.qq.com/s/-07O9hiNL1e9llPDsaPoWQ) <br> A:扑克牌 入门          <br> B: 地图探险 普及−      <br> C: 小木棍 普及/提高−       <br> D: 接龙 提高+/省选−|
| [CSP-S 2024 题解](https://mp.weixin.qq.com/s/MVvztSH8LW13eP5lc7cHjg) <br> A:决斗 普及−           <br> B: 超速检测 普及+/提高 <br> C: 染色 提高+/省选−        <br> D: 擂台游戏 NOI/NOI+/CTSC |
| [CSP-J 2023 题解](https://mp.weixin.qq.com/s/-RalfMmoFQLGlP9AD5VCAA) <br> A:小苹果 普及−         <br> B: 公路 普及−         <br> C: 一元二次方程 普及/提高−   <br> D: 旅游巴士 普及+/提高 |
| [CSP-S 2023 题解](https://mp.weixin.qq.com/s/BEsjZsgI-RhVGbWyeVgHUw) <br> A:密码锁 普及−         <br> B: 消消乐 提高+/省选−  <br> C: 结构体 提高+/省选−       <br> D: 种树 提高+/省选− |
| [CSP-J 2022 题解](https://mp.weixin.qq.com/s/6_U-twcGKNhwQvhM6z57Dg) <br> A:乘方 入门            <br> B: 解密 普及−         <br> C: 逻辑表达式 普及+/提高    <br> D: 上升点列 普及/提高− |
| [CSP-S 2022 题解](https://mp.weixin.qq.com/s/2_6rHQGCn6DUijg9Bevnyw) <br> A:假期计划 提高+/省选−  <br> B: 策略游戏 普及+/提高  <br> C: 星战 省选/NOI−         <br> D: 数据传输 省选/NOI−	 |
| [CSP-J 2021 题解](https://mp.weixin.qq.com/s/711kAAF8NNefVLC8qNvvBA) <br> A:分糖果 普及−	       <br> B: 插入排序 普及/提高−  <br> C: 网络连接 普及/提高−      <br> D: 小熊的果篮 普及+/提高	 |
| CSP-S 2021 题解                                                      <br> A:廊桥分配 普及+/提高	  <br> B: 括号序列 提高+/省选− <br> C: 回文 普及/提高−          <br> D: 交通规划 省选/NOI−	 |



## 一、廊桥分配  


![](https://res2025.tiankonguse.com/images/2025/08/09/002.png)  


题意：一个机场有 n 个廊桥，需要分给国际机场航班和国内机场航班。  
国际航班只能进入国际机场的廊桥，如果满了，就需要停到远机位。  
国内航班只能进入国内机场的廊桥，如果停满了，一样也只能停到远机位。  
每个航班都是优先停到廊桥，其次是远机位。  
问如何分配，才能使得停留在廊桥的飞机尽量多。  


思路：二分+线段树  


如果可以预处理出所有数量各自廊桥的飞机数量，枚举所有分配方案，求和，取最大值即可。  


假设廊桥是无限的，但是有编号，会优先选择最小编号的廊桥，看下各个航班会怎么匹配廊桥吧。  
题意要求先到先得，所以先对航班到达时间 t 排序。  


t0 时刻到达一个飞机后，我们需要找到所有空廊桥的最小编号。  
空廊桥，意味着廊桥里面的飞机的离开时间小于 t0，即找到所有离开时间大于 t0 且编号最小的廊桥。  


对于这个求大于一个值求最小编号的问题，可以使用二分线段树来做。  


二分求线段树的前缀的最小值，直到找到第一个不满足的边界，则下一个就是满足的。


```cpp
sort(flights.begin(), flights.end());
segTree.Init(nm);
segTree.Build();
for (auto [a, b] : flights) {
  int l = 1, r = nm + 1;
  while (l < r) {
    int mid = (l + r) >> 1;
    if (segTree.QueryMin(1, mid) <= a) {
      r = mid;
    } else {
      l = mid + 1;
    }
  }
  nums[l]++;  // [a,b] 可以使用第 l 个廊桥
  ll oldVal = segTree.QueryMin(l, l);
  segTree.Update(l, b - oldVal);
}
```

每个航班最终选择哪个编号储存在 nums 中。  
如果分配了 n 个廊桥，答案就是前 n 个 nums 的和，故预处理求前缀和。  



```cpp
for (int i = 1; i <= n; i++) {
  nums[i] += nums[i - 1];  // 前 i 个廊桥，最多可以容纳的飞机数量
}
```

最后枚举国际廊桥和国内廊桥的个数，求最大值。  


```cpp
int ans = 0;
for (int i = 0; i <= n; i++) {
  ans = max(ans, nums1[i] + nums2[n - i]);
}
printf("%d\n", ans);
```


## 二、括号序列

![](https://res2025.tiankonguse.com/images/2025/08/09/003.png)  


题意：给一个星号与括号匹配的规则，部分位置使用问号代替，问




## 三、回文


## 四、交通规划


## 五、最后


《完》  


-EOF-  


本文公众号：天空的代码世界  
个人微信号：tiankonguse  
公众号 ID：tiankonguse-code  
